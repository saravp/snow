<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_page">
    <sys_ui_page action="INSERT_OR_UPDATE">
        <category>general</category>
        <client_script><![CDATA[var app = angular.module('angularApp', []);
app.controller('MainCtrl', function ($scope) {
    $scope.apiKeyValue = '';
    $scope.envValue = '';
    $scope.notificationVal = false;
    var insert = true;
    var api_PV = '';
    
    $scope.onInitCode = (function () {
        var gr = new GlideRecord('x_261942_ot_apikey');
        gr.orderByDesc('sys_created_on');
        gr.setLimit(1);
        gr.query();
        if (gr.next()) {
            insert = false;
            $scope.apiKeyValue = gr.apikey;
            $scope.envValue = gr.url;
            api_PV = $scope.apiKeyValue;
            $scope.envValue = gr.url;
            $scope.notificationVal = gr.notification_s;
        }
    })();
    
    $scope.insertData = function () {
        if (insert === true && $scope.apiKeyValue && $scope.envValue) {
            var newRecord = new GlideRecord('x_261942_ot_apikey');
            newRecord.initialize();
            newRecord.setValue('apikey', $scope.apiKeyValue);
            newRecord.setValue('url', $scope.envValue);
            newRecord.setValue('notification_s', $scope.notificationVal);
            newRecord.insert();
        } else if ($scope.apiKeyValue && $scope.envValue){
            var gr = new GlideRecord('x_261942_ot_apikey');
            gr.addQuery('apikey', api_PV);
            gr.query();
            while (gr.next()) {
                gr.setValue('apikey', $scope.apiKeyValue);
                gr.setValue('url', $scope.envValue);
                gr.setValue('notification_s', $scope.notificationVal);
                gr.update();
            }
        } else {
            alert("Please fill both the fields");
        }
        
    };
    
    
});]]></client_script>
        <description>This is the UI page for setting up the integration</description>
        <direct>false</direct>
        <endpoint>x_261942_ot_Settings.do</endpoint>
        <html><![CDATA[<?xml version="1.0" encoding="utf-8" ?>
<j:jelly trim="false" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null" xmlns:g2="null">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
        crossorigin="anonymous">
    </link>
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet"></link>
    <style>
        .ot-settings {
            max-width: 750px;
            padding-top: 30px;
			font-family: 'Open Sans', sans-serif;
			font-size: 12px;
        }

        #body{
                font-size: 1.2rem;
				font-family: 'Open Sans', sans-serif;
            }
    </style>

    <body id="body" ng-app="angularApp">
        <div ng-controller="MainCtrl">

            <!-- <div id="jumbotron" class="w-100 p-3 h-50 d-inline-block">
                <h1 style="font-size: 2.5rem">OneTrust</h1>
                <p style="font-size: 1.2rem">Privacy Mangament Software</p>
            </div> -->
<!--             <div class="container" style="margin-top: 5%;">
                <form name="myForm">
                    <div class="form-group">
                        <label for="settingsFormApiKey">ApiKey</label>
                        <input type="text" class="form-control" name="apiKeyValue" id="settingsFormApiKeyInput"
                            placeholder="Please Enter ApiKey" ng-model="apiKeyValue" ng-change="onApiKeyChanges()"
                            ng-value="apiKeyValue" />
                    </div>
                    <div class="form-group">
                        <label for="settingsFormEnvironment">Environment</label>
                        <input type="text" class="form-control" name="envValue" id="settingsFormEnvironmentInput"
                            placeholder="Please Enter Environment" ng-model="envValue" ng-value="envValue" ng-change="onEnvChnage(envValue)" />
                    </div>
                    <div class="form-group">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="notificationcheck" ng-model="notificationVal"
                                name="notification" />
                            <label class="form-check-label" for="notificationcheck" style="margin-left:0.5%;">
                                Email Notifications
                            </label>
                        </div>
                    </div>
                    <p>{{notificationVal}}</p>
                    <div>
                        <button type="submit" class="btn btn-primary mb-2" style="margin-top: 10px" ng-click="insertData()" onclick="window.location.reload(true);">Submit</button>
                    </div>
                </form>
            </div> -->
 <div class="container ot-settings">
    <h2 style="margin-bottom: 2rem;">OneTrust Settings</h2>
    <form>
      <fieldset class="form-group">
        <label for="otSettingsApiKey">Api Key</label>
        <input type="text" 
               class="form-control" 
               id="otSettingsApiKey" 
               placeholder="Please Enter OneTrust ApiKey" 
               ng-model="apiKeyValue" 
               ng-change="onApiKeyChanges()"
               ng-value="apiKeyValue" />
      </fieldset>
      <fieldset class="form-group">
        <label for="otSettingsEnv">Environment URL</label>
        <input 
               type="text" 
               class="form-control" 
               id="exampleInputPassword1" 
               placeholder="Please Enter OneTrust Environment" 
               ng-model="envValue" ng-value="envValue" 
               ng-change="onEnvChnage(envValue)"/>
      </fieldset>
     <!--  <div class="checkbox">
        <label style="font-weight: bold;">
          <input type="checkbox" 
             ng-model="notificationVal"
             id="notificationcheck"
             name="emailNotification"
             value="notificationVal" 
             />
            Email Notification
        </label>
      </div> -->
      <button type="submit" class="btn btn-primary"
            style="margin-top: 10px" 
            ng-click="insertData()"     
            onclick="window.location.reload(true);"
        >Submit</button>
    </form>
</div>
        </div>
    </body>
</j:jelly>]]></html>
        <name>Settings</name>
        <processing_script/>
        <sys_class_name>sys_ui_page</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-10-05 21:20:53</sys_created_on>
        <sys_id>4f3e87904fc96300f20f1b818110c758</sys_id>
        <sys_mod_count>10</sys_mod_count>
        <sys_name>Settings</sys_name>
        <sys_package display_value="OT" source="x_261942_ot">2fd4a5334f231300f20f1b818110c702</sys_package>
        <sys_policy/>
        <sys_scope display_value="OT">2fd4a5334f231300f20f1b818110c702</sys_scope>
        <sys_update_name>sys_ui_page_4f3e87904fc96300f20f1b818110c758</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-10-05 23:04:47</sys_updated_on>
    </sys_ui_page>
</record_update>
